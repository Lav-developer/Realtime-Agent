*{box-sizing:border-box}
body{font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial;background:#f7fafc;margin:0}
#app{display:flex;height:100vh}
#sidebar{width:240px;background:#0f1724;color:#fff;padding:16px}
#sidebar h2{margin:0 0 12px;font-size:18px}
#users{list-style:none;padding:0;margin:0}
#users li{padding:8px 6px;border-bottom:1px solid rgba(255,255,255,0.04);display:flex;align-items:center;gap:8px}
#users li .avatar{width:28px;height:28px;border-radius:50%;background:#334155;display:inline-flex;align-items:center;justify-content:center;color:#fff;font-size:12px}
#main{flex:1;display:flex;flex-direction:column}
header{padding:12px;border-bottom:1px solid #e6e6e6;display:flex;align-items:center;justify-content:space-between;gap:8px}
#identity{display:flex;align-items:center;gap:8px}
#identity input{padding:8px;border-radius:6px;border:1px solid #ddd}
#identity button{padding:8px 12px;border-radius:6px;border:0;background:#111827;color:#fff}
#meName{font-weight:600;margin-left:6px}
#unreadBadge{background:#dc2626;color:#fff;padding:4px 8px;border-radius:999px;font-size:12px}
.notif-toggle{margin-left:8px;font-size:13px;color:#334155;display:inline-flex;align-items:center;gap:6px}
.notif-toggle input{width:14px;height:14px}
#messages{flex:1;padding:16px;overflow:auto;background:linear-gradient(180deg,#f8fafc, #eef2ff)}
#messages .msg{margin-bottom:12px;padding:10px;border-radius:12px;background:#fff;box-shadow:0 6px 12px rgba(15,23,42,0.06);max-width:70%}
#messages .msg.own{margin-left:auto;background:linear-gradient(135deg,#1f2937,#111827);color:#fff}
#messages .meta{font-size:12px;color:#666;margin-bottom:6px}
#messages .meta.own{color:#cbd5e1}
#messages .avatar{width:36px;height:36px;border-radius:8px;background:#e2e8f0;display:inline-flex;align-items:center;justify-content:center;margin-right:8px}
.msg-row{display:flex;align-items:flex-start;gap:10px;justify-content:flex-start}
.msg-row.own{flex-direction:row-reverse;justify-content:flex-end}
.msg.system{background:transparent;box-shadow:none;padding:6px 0;}
.system-compact{background:#fff;border-radius:10px;box-shadow:0 4px 10px rgba(2,6,23,0.06);color:#374151;padding:8px 12px;text-align:center;display:inline-block;font-weight:500}
.system-compact small{color:#6b7280;margin-left:8px;font-weight:400}
.typing{padding:8px 16px;color:#374151;font-style:italic}
.toast-container{position:fixed;right:16px;bottom:16px;display:flex;flex-direction:column;gap:8px;z-index:999}
.toast{background:#111827;color:#fff;padding:8px 12px;border-radius:8px;box-shadow:0 6px 18px rgba(2,6,23,0.6)}
.system-toast{background:#fff;color:#111827;padding:8px 12px;border-radius:8px;border:1px solid rgba(0,0,0,0.06)}

form{display:flex;padding:12px;border-top:1px solid #e6e6e6}
form input{flex:1;padding:10px;border:1px solid #ddd;border-radius:10px;margin-right:8px}
form button{padding:10px 14px;border-radius:10px;border:0;background:#0f1724;color:#fff}

@media (max-width:900px){
	/* hide sidebar on small screens */
	#sidebar{display:none}
	header{flex-direction:column;align-items:stretch;gap:6px}
	#identity{width:100%;justify-content:space-between}
	.notif-toggle{order:2;margin-left:0}
	#meName{order:3}
	#unreadBadge{order:4}
	/* When joined, hide the name input and join button to avoid layout shift on mobile */
	body.joined #identity input,
	body.joined #identity button,
	body.joined .notif-toggle{display:none}
	body.joined #meName{display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:65%}
	form{position:sticky;bottom:0;background:linear-gradient(180deg,#fff, #f7fafc);padding:10px;border-top:1px solid #e6e6e6}
	form input{font-size:16px;padding:12px}
	form button{padding:12px 16px}
	/* compact messages for mobile: full-width, no avatars */
	.msg-row{gap:6px}
	.msg-row .avatar{display:none}
	#messages{padding:12px}
	#messages .msg{max-width:100%;border-radius:12px;padding:10px}
	#messages .msg.own{margin-left:0;margin-right:0}
	.system-compact{font-size:14px;padding:6px 10px}
	.typing{padding:6px 10px}
	/* center toasts on mobile and move to top */
	.toast-container{left:50%;transform:translateX(-50%);right:auto;top:12px;bottom:auto}
	.toast{padding:10px 14px}
}

@media (max-width:480px){
	header{padding:8px}
	.notif-toggle{font-size:12px}
	.system-compact{font-size:13px}
	form input{font-size:15px}
}